class BloggerScript{constructor(e={}){this._config=e}err(e){return console.log(e),e}createRT(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=r.length;for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*s));return t}resizeImage(e,t=!1){if(!t)return e;let r=/\/(s|w|h)\d{1,4}-((w|s|h)(\d{1,4})+-)?(c{1,2}|p-k-no-nu|rw)/gi,s=/\=(s|w|h)\d{1,4}-((w|s|h)(\d{1,4})+-)?(c{1,2}|p-k-no-nu|rw)/gi,n=/(\/(w|h|s)\d{1,4}\/)/gi,i=/(\=(w|h|s)\d{1,4})$/gi,a=/\-(rw)$/.test(t);return n.test(e)&&(e=e.replace(n,"/s72-c/")),i.test(e)&&(e=e.replace(i,"=s72-c")),a&&(e=e.replace(/\.(gif|jpe?g|tiff?|png|bmp)$/,".webp")),e.match(r)?e.replace(r,`/${t}`):e.match(s)?e.replace(s,`=${t}`):e}shuffle(e){var t,r,s=e.length;if(0===s)return!1;for(;--s;)t=Math.floor(Math.random()*(s+1)),r=e[s],e[s]=e[t],e[t]=r;return e}shuffle2(e,t){return Math.floor(Math.random()*(t-e))+e}sort(e,t){if("Update"==t||"Added"==t){let r="Update"==t?"updated":"published";e=e.sort(function(e,t){return e[r]<t[r]?-1:e[r]>t[r]?1:0}).reverse()}else"A-Z"!=t&&"Z-A"!=t||(e=e.sort((e,t)=>e.title.localeCompare(t.title,void 0,{numeric:!0})),"Z-A"==t&&(e=e.reverse()));return e}xhr(e,t=this.err){let r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){if(4==this.readyState&&200==this.status||304==this.status){let e=this.responseText,r=JSON.parse(e.substring(e.indexOf("{"),e.lastIndexOf("}")+1));t&&t(r)}else 4==this.readyState&&t&&t({})},r.open("GET",e,!0),r.send()}xhr2(e,t=this.err){let r=document.createElement("script"),s="xhr2"+this.createRT(7);return window[s]=function(e){return t(e)},r.src=`${e}&callback=window.${s}`,r.onerror=function(e){console.log(e),t({})},r.async=!0,(document.body||document.getElementsByTagName("body")[0]).appendChild(r)}getId(e){return e.split("post-")[1]}getAuthor(e){let t={};return"name"in e&&(t.name=e.name.$t),"uri"in e&&(t.uri=e.uri.$t),"gd$image"in e&&"src"in e.gd$image&&-1==e.gd$image.src.indexOf("https://img1.blogblog.com/")?t.image=this.resizeImage(e.gd$image.src,this._config.sizeImage):t.image=this._config.noImage?this.resizeImage(this._config.noImage,this._config.sizeImage):"",t}getDefault(e){let t=["published","updated","content","summary","title"],r={};return t.forEach(t=>{t in e&&(r[t]=e[t].$t,"published"==t&&(r.date=this.getTime(e[t].$t)))}),r}getImage(e){let t=this._config.noImage?this.resizeImage(this._config.noImage,this._config.sizeImage):"";if("media$thumbnail"in e)return this.resizeImage(e.media$thumbnail.url,this._config.sizeImage);if("content"in e){let r=e.content.$t,s=r.indexOf("<img"),n=r.indexOf('src="',s),i=r.indexOf('"',n+5),a=r.substr(n+5,i-n-5);return-1!=s&&-1!=n&&-1!=i&&""!=a?a:t}return t}getTime(e){if(/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/.test(e)){var t=e,r=t.substring(0,4),s=t.substring(5,7),n=t.substring(8,10),i=new Array;return i[1]="Jan",i[2]="Feb",i[3]="Mar",i[4]="Apr",i[5]="May",i[6]="Jun",i[7]="Jul",i[8]="Aug",i[9]="Sep",i[10]="Oct",i[11]="Nov",i[12]="Dec",n+" "+i[parseInt(s,10)]+" "+r}return!1}getFeed(e){let t=new Array;if(e.feed&&e.feed.entry)for(let r=0;r<e.feed.entry.length;r++){const s=e.feed.entry[r];let n=this.getDefault(s);n.id=this.getId(s.id.$t),n.link=s.link.find(e=>"alternate"==e.rel).href,n.image=this.getImage(s),n.label=s.category.map(e=>e.term),"author"in s&&(n.author=this.getAuthor(s.author[0])),t.push(n)}return t}}class BloggerRandom extends BloggerScript{constructor(e={}){super(e)}getTotalResults(e){let t=e.feed.openSearch$totalResults.$t,r=this._config.jumlah;if(r){if(t<r)return!1;t=this.shuffle2(1,t-r)}else t=t<=150?1:this.shuffle2(1,t-150),r=150;return{"start-index":t,"max-results":r}}getItems(e){if("entry"in e.feed){let t=this.getFeed(e);return t=this.shuffle(t),t}return[]}run(e,t=this.err,r=!0){let s=this,n=r?"xhr":"xhr2";s[n](`${e}?alt=json-in-script&max-results=0`,r=>{let i=s.getTotalResults(r);s[n](`${e}?alt=json-in-script&start-index=${i["start-index"]}&max-results=${i["max-results"]}`,e=>{t(s.getItems(e))})})}}class BloggerRelated extends BloggerScript{constructor(e={}){super(e)}run(e,t=this.err,r=!0){let s=this,n=0,i=document.location.pathname,a=s._config.labels,o=s._config.jumlah,l=r?"xhr":"xhr2";if(s._config.arr=new Array,"undefined"==a||""==a||0==a.length)return t([]);a.forEach(r=>{s[l](`${e}/-/${r}?alt=json-in-script&max-results=${o}`,e=>{let r=s.getFeed(e);if(r.forEach(e=>{s._config.arr.some(t=>t.id==e.id)||s._config.arr.push(e)}),n++,n==a.length){if(0==s._config.arr.length)return t([]);let e=s._config.arr.map(e=>new URL(e.link).pathname==i).indexOf(!0);s._config.arr.splice(e,1);let r=s.shuffle(s._config.arr).slice(0,o);return t(r)}})})}}class BloggerSitemap extends BloggerScript{constructor(e){super(e),this._settings={"start-index":1,"max-results":150,"total-get":0,posts:new Array}}alphaSort(e){let t=new Array,r=new Array,s="";0!=e.length&&this.sort(e,"A-Z").forEach(e=>{let r=e.title.charAt(0).toLowerCase();-1==s.indexOf(r)?(s+=r,t[r]=[e]):t[r].push(e)});for(const e in t)if(Object.hasOwnProperty.call(t,e)){const s=t[e];r.push({id:e,items:s})}return r}run(e,t=this.err,r=!0){const s=this._settings,n=this._config,i=n.order||"updated",a=`${e}?alt=json-in-script&start-index=${s["start-index"]}&max-results=${s["max-results"]}&orderby=${i}`,o=i=>{if("entry"in i.feed){let a=i.feed.openSearch$totalResults.$t||0;Array.prototype.push.apply(s.posts,this.getFeed(i)),i.feed.entry.length>=s["max-results"]?(s["start-index"]+=s["max-results"],n.firstContent&&1==s["total-get"]&&t(s.posts,s["total-get"],!1,a),this.run(e,t,r)):t(s.posts,s["total-get"],!0,a)}else t(s.posts,s["total-get"],!0,s.posts.length)},l=r?"xhr":"xhr2";s["total-get"]++,this[l](a,o)}}class BloggerComments extends BloggerScript{constructor(e){super(e)}getComments(e){let t=new Array;if(e.feed&&e.feed.entry)for(let r=0;r<e.feed.entry.length;r++){const s=e.feed.entry[r];let n=this.getDefault(s);n.id=this.getId(s.id.$t),n.link=s.link.find(e=>"alternate"==e.rel).href,"author"in s&&(n.author=this.getAuthor(s.author[0])),t.push(n)}return t}run(e,t,r,s=!0){let n=s?"xhr":"xhr2",i=this._config.mainUrl||"",a=this._config.contentType||"default",o=e?`/${e}/`:"/";this[n](`${i}/feeds${o}comments/${a}?alt=json&max-results=${t}`,e=>{let t=this.getComments(e);r(t)})}}