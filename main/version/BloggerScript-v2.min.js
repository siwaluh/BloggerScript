class BloggerScript{constructor(t={}){this._config=t}err(t){return console.log(t),t}createRT(t){let e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=r.length;for(let n=0;n<t;n++)e+=r.charAt(Math.floor(Math.random()*s));return e}resizeImage(t,e=!1){if(!e)return t;let r=/\/(s|w|h)\d{1,4}-((w|s|h)(\d{1,4})+-)?(c{1,2}|p-k-no-nu|rw)/gi,s=/\=(s|w|h)\d{1,4}-((w|s|h)(\d{1,4})+-)?(c{1,2}|p-k-no-nu|rw)/gi,n=/(\/(w|h|s)\d{1,4}\/)/gi,i=/(\=(w|h|s)\d{1,4})$/gi,o=/\-(rw)$/.test(e);return n.test(t)&&(t=t.replace(n,"/s72-c/")),i.test(t)&&(t=t.replace(i,"=s72-c")),o&&(t=t.replace(/\.(gif|jpe?g|tiff?|png|bmp)$/,".webp")),t.match(r)?t.replace(r,`/${e}`):t.match(s)?t.replace(s,`=${e}`):t}shuffle(t){var e,r,s=t.length;if(0===s)return!1;for(;--s;)e=Math.floor(Math.random()*(s+1)),r=t[s],t[s]=t[e],t[e]=r;return t}shuffle2(t,e){return Math.floor(Math.random()*(e-t))+t}sort(t,e){if("Update"==e||"Added"==e){let r="Update"==e?"updated":"published";t=t.sort(function(t,e){return t[r]<e[r]?-1:t[r]>e[r]?1:0}).reverse()}else"A-Z"!=e&&"Z-A"!=e||(t=t.sort((t,e)=>t.title.localeCompare(e.title,void 0,{numeric:!0})),"Z-A"==e&&(t=t.reverse()));return t}xhr(t,e=this.err){let r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){if(4==this.readyState&&200==this.status||304==this.status){let t=this.responseText,r=JSON.parse(t.substring(t.indexOf("{"),t.lastIndexOf("}")+1));e&&e(r)}else 4==this.readyState&&e&&e({})},r.open("GET",t,!0),r.send()}xhr2(t,e=this.err){let r=document.createElement("script"),s="xhr2"+this.createRT(7);return window[s]=function(t){return e(t)},r.src=`${t}&callback=window.${s}`,r.onerror=function(t){console.log(t),e({})},r.async=!0,(document.body||document.getElementsByTagName("body")[0]).appendChild(r)}getId(t){return t.split("post-")[1]}getAuthor(t){let e={};return"name"in t&&(e.name=t.name.$t),"uri"in t&&(e.uri=t.uri.$t),"gd$image"in t&&"src"in t.gd$image&&-1==t.gd$image.src.indexOf("https://img1.blogblog.com/")?e.image=this.resizeImage(t.gd$image.src,this._config.sizeImage):e.image=this._config.noImage?this.resizeImage(this._config.noImage,this._config.sizeImage):"",e}getDefault(t){let e=["published","updated","content","summary","title"],r={};return e.forEach(e=>{e in t&&(r[e]=t[e].$t,"published"==e&&(r.date=this.getTime(t[e].$t)))}),r}getImage(t){let e=this._config.noImage?this.resizeImage(this._config.noImage,this._config.sizeImage):"";if("media$thumbnail"in t)return this.resizeImage(t.media$thumbnail.url,this._config.sizeImage);if("content"in t){let r=t.content.$t,s=r.indexOf("<img"),n=r.indexOf('src="',s),i=r.indexOf('"',n+5),o=r.substr(n+5,i-n-5);return-1!=s&&-1!=n&&-1!=i&&""!=o?o:e}return e}getTime(t){if(/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/.test(t)){var e=t,r=e.substring(0,4),s=e.substring(5,7),n=e.substring(8,10),i=new Array;return i[1]="Jan",i[2]="Feb",i[3]="Mar",i[4]="Apr",i[5]="May",i[6]="Jun",i[7]="Jul",i[8]="Aug",i[9]="Sep",i[10]="Oct",i[11]="Nov",i[12]="Dec",n+" "+i[parseInt(s,10)]+" "+r}return!1}getFeed(t){let e=new Array;if(t.feed&&t.feed.entry)for(let r=0;r<t.feed.entry.length;r++){const s=t.feed.entry[r];let n=this.getDefault(s);n.id=this.getId(s.id.$t),n.link=s.link.find(t=>"alternate"==t.rel).href,n.image=this.getImage(s),n.label=s.category.map(t=>t.term),"author"in s&&(n.author=this.getAuthor(s.author[0])),n.comments_count=s.thr$total.$t,e.push(n)}return e}}class BloggerRandom extends BloggerScript{constructor(t={}){super(t)}getTotalResults(t){let e=t.feed.openSearch$totalResults.$t,r=this._config.jumlah;if(r){if(e<r)return!1;e=this.shuffle2(1,e-r)}else e=e<=150?1:this.shuffle2(1,e-150),r=150;return{"start-index":e,"max-results":r}}getItems(t){if("entry"in t.feed){let e=this.getFeed(t);return e=this.shuffle(e),e}return[]}run(t,e=this.err,r=!0){let s=this,n=r?"xhr":"xhr2";s[n](`${t}?alt=json-in-script&max-results=0`,r=>{let i=s.getTotalResults(r);s[n](`${t}?alt=json-in-script&start-index=${i["start-index"]}&max-results=${i["max-results"]}`,t=>{e(s.getItems(t))})})}}class BloggerRelated extends BloggerScript{constructor(t={}){super(t)}run(t,e=this.err,r=!0){let s=this,n=0,i=document.location.pathname,o=s._config.labels,a=s._config.jumlah,l=r?"xhr":"xhr2";if(s._config.arr=new Array,"undefined"==o||""==o||0==o.length)return e([]);o.forEach(r=>{s[l](`${t}/-/${r}?alt=json-in-script&max-results=${a}`,t=>{let r=s.getFeed(t);if(r.forEach(t=>{s._config.arr.some(e=>e.id==t.id)||s._config.arr.push(t)}),n++,n==o.length){if(0==s._config.arr.length)return e([]);let t=s._config.arr.map(t=>new URL(t.link).pathname==i).indexOf(!0);s._config.arr.splice(t,1);let r=s.shuffle(s._config.arr).slice(0,a);return e(r)}})})}}class BloggerSitemap extends BloggerScript{constructor(t){super(t),this._settings={"start-index":1,"max-results":150,"total-get":0,posts:new Array}}alphaSort(t){let e=new Array,r=new Array,s="";0!=t.length&&this.sort(t,"A-Z").forEach(t=>{let r=t.title.charAt(0).toLowerCase();-1==s.indexOf(r)?(s+=r,e[r]=[t]):e[r].push(t)});for(const t in e)if(Object.hasOwnProperty.call(e,t)){const s=e[t];r.push({id:t,items:s})}return r}run(t,e=this.err,r=!0){const s=this._settings,n=this._config,i=n.order||"updated",o=`${t}?alt=json-in-script&start-index=${s["start-index"]}&max-results=${s["max-results"]}&orderby=${i}`,a=i=>{if("entry"in i.feed){let o=i.feed.openSearch$totalResults.$t||0;Array.prototype.push.apply(s.posts,this.getFeed(i)),i.feed.entry.length>=s["max-results"]?(s["start-index"]+=s["max-results"],n.firstContent&&1==s["total-get"]&&e(s.posts,s["total-get"],!1,o),this.run(t,e,r)):e(s.posts,s["total-get"],!0,o)}else e(s.posts,s["total-get"],!0,s.posts.length)},l=r?"xhr":"xhr2";s["total-get"]++,this[l](o,a)}}class BloggerComments extends BloggerScript{constructor(t){super(t)}getComments(t){let e=new Array;if(t.feed&&t.feed.entry)for(let r=0;r<t.feed.entry.length;r++){const s=t.feed.entry[r];let n=this.getDefault(s);n.id=this.getId(s.id.$t),"thr$in-reply-to"in s&&(n["post-id"]=this.getId(s["thr$in-reply-to"].ref)),"thr$in-reply-to"in s&&(n["post-source"]=s["thr$in-reply-to"].source.replace("http://","https://")),n.link=s.link.find(t=>"alternate"==t.rel).href,"author"in s&&(n.author=this.getAuthor(s.author[0])),e.push(n)}return e}getPostInfo(t,e,r=!0){if(0!=t.length){let s=0,n={item:[]},i=r?"xhr":"xhr2";t.forEach(r=>{"post-id"in r&&"post-source"in r&&new Promise(t=>{r["post-id"]in n?(s++,t()):(n[`${r["post-id"]}`]="loading",this[i](`${r["post-source"]}?alt=json-in-script`,e=>{let i;i=!!(e&&"entry"in e)&&{title:e.entry.title.$t,label:e.entry.category.map(t=>t.term),comments_count:e.entry.thr$total.$t},n[`${r["post-id"]}`]=i,r["post-title"]=i,s++,t()}))}).then(()=>{if(s==t.length){let r=t.map(t=>(t["post-info"]=n[`${t["post-id"]}`],t));e(r)}})})}else e([])}run(t,e,r,s=!0){let n=s?"xhr":"xhr2",i=this._config.mainUrl||"",o=this._config.contentType||"default",a=t?`/${t}/`:"/";this[n](`${i}/feeds${a}comments/${o}?alt=json&max-results=${e}`,t=>{let e=this.getComments(t);r(e)})}}